<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

     <!-- Tipos de Contribuyentes -->


        <record id="contrib_register_previred" model="hr.contribution.register">
            <field name="name">Previred</field>
            <field name='partner_id' ref='previred'/>
        </record>

        <record id="contrib_register_sii" model="hr.contribution.register">
            <field name="name">Sii</field>
            <field name='partner_id' ref='sii'/>
        </record>


        <!-- Decimal Precision -->

        <record forcecreate="True" id="hr_payroll.decimal_payroll" model="decimal.precision">
            <field name="name">Payroll</field>
            <field name="digits">0</field>
        </record>

        <record forcecreate="True" id="hr_payroll.decimal_payroll_rate" model="decimal.precision">
            <field name="name">Payroll Rate</field>
            <field name="digits">0</field>
        </record>



       <!-- Salary Rules -->
        <record id="hr_rule_1" model="hr.salary.rule">
            <field name="name">SUELDO BASE</field>
            <field name="sequence" eval="1"/>
            <field name="code">SUELDO</field>
            <field name="category_id" ref="IMPONIBLE"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">if (contract.type_id.name == 'Sueldo Empresarial') and ( contract.wage >=round(payslip.indicadores_id.tope_imponible_afp*payslip.indicadores_id.uf)):
    result = round(payslip.indicadores_id.tope_imponible_afp*payslip.indicadores_id.uf)
elif (contract.type_id.name == 'Sueldo Empresarial'):
    result = contract.wage
else:
    result = result = round((contract.wage / 30) * worked_days.WORK100.number_of_days)</field>
        </record>




        <record id="hr_rule_2" model="hr.salary.rule">
            <field name="name">AJUSTE LEY SUELDO BASE</field>
            <field name="sequence" eval="2"/>
            <field name="code">ALSB</field>
            <field name="category_id" ref="IMPONIBLE"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = payslip.indicadores_id.sueldo_minimo > contract.wage</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = round(((payslip.indicadores_id.sueldo_minimo - contract.wage) / 30) * worked_days.WORK100.number_of_days)
</field>

        </record>



        <record id="hr_rule_3" model="hr.salary.rule">
            <field name="name">OTROS IMPONIBLES</field>
            <field name="sequence" eval="3"/>
            <field name="code">BONO</field>
            <field name="category_id" ref="IMPONIBLE"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.otros_imp > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = ((contract.otros_imp / 30) * worked_days.WORK100.number_of_days)</field>
        </record>

        <record id="hr_rule_4" model="hr.salary.rule">
            <field name="name">HORAS EXTRA ART 32</field>
            <field name="sequence" eval="4"/>
            <field name="code">HEX50</field>
            <field name="category_id" ref="IMPONIBLE"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = inputs.HEX50 and inputs.HEX50.amount > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = round(0.00777777*contract.wage*inputs.HEX50.amount)</field>
        </record>

        <record id="hr_rule_5" model="hr.salary.rule">
            <field name="name">HORAS DESCUENTO</field>
            <field name="sequence" eval="5"/>
            <field name="code">HEXDE</field>
            <field name="category_id" ref="IMPONIBLE"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = inputs.HEXDE and inputs.HEXDE.amount > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = round(0.005185*contract.wage*inputs.HEXDE.amount)*(-1)</field>
        </record>

        <record id="hr_rule_6" model="hr.salary.rule">
            <field name="name">GRATIFICACION LEGAL</field>
            <field name="sequence" eval="8"/>
            <field name="code">GRAT</field>
            <field name="category_id" ref="IMPONIBLE"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = (contract.gratificacion_legal is False)</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">GRATI=round(categories.IMPONIBLE * 25 / 100 )
if (contract.type_id.name == 'Sueldo Empresarial'):
    result = 0
elif GRATI > (4.75 * payslip.indicadores_id.sueldo_minimo /12):
    result = round (4.75 * payslip.indicadores_id.sueldo_minimo / 12)
else:
    result = GRATI</field>
        </record>

        <record id="hr_rule_7" model="hr.salary.rule">
            <field name="name">BONO DE PRODUCCION</field>
            <field name="sequence" eval="7"/>
            <field name="code">PROD</field>
            <field name="category_id" ref="IMPONIBLE"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = (inputs.PROD and inputs.PROD.amount > 0)</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = inputs.PROD.amount</field>
        </record>

         <record id="hr_rule_8" model="hr.salary.rule">
            <field name="name">COMISIONES</field>
            <field name="sequence" eval="6"/>
            <field name="code">COMI</field>
            <field name="category_id" ref="IMPONIBLE"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = (inputs.COMI and inputs.COMI.amount > 0)</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = inputs.COMI.amount</field>
        </record>


        <record id="hr_rule_9" model="hr.salary.rule">
            <field name="name">GRATIFICACION LEGAL</field>
            <field name="sequence" eval="9"/>
            <field name="code">GRAT</field>
            <field name="category_id" ref="IMPONIBLE"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = (contract.gratificacion_legal is True) &amp; (inputs.GRAT.amount > 0)</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = inputs.GRAT.amount</field>
        </record>

        <record id="hr_rule_10" model="hr.salary.rule">
            <field name="name">AGUINALDO</field>
            <field name="sequence" eval="10"/>
            <field name="code">AGUI</field>
            <field name="category_id" ref="IMPONIBLE"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = (inputs.AGUI and inputs.AGUI.amount > 0)</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = inputs.AGUI.amount</field>
        </record>





        <record id="hr_rule_11" model="hr.salary.rule">
            <field name="name">TOTAL IMPONIBLE</field>
            <field name="sequence" eval="11"/>
            <field name="code">TOTIM</field>
            <field name="category_id" ref="SUBT"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = round(categories.IMPONIBLE)</field>
        </record>

        <record id="hr_rule_12" model="hr.salary.rule">
            <field name="name">ASIGNACION FAMILIAR</field>
            <field name="sequence" eval="12"/>
            <field name="code">ASIGFAM</field>
            <field name="category_id" ref="NOIMPO"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = ((contract.carga_familiar != 0) or (contract.carga_familiar_maternal != 0) or (contract.carga_familiar_invalida != 0)) &amp; (payslip.indicadores_id.asignacion_familiar_tercer >= contract.wage) &amp; (contract.pension is False)</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">if worked_days.WORK100.number_of_days > 25:
 dias= 30
else:
 dias= worked_days.WORK100.number_of_days

carga= contract.carga_familiar + contract.carga_familiar_maternal + contract.carga_familiar_invalida


if worked_days.WORK100.number_of_days == 0:
    result = 0
elif payslip.indicadores_id.asignacion_familiar_primer >= categories.IMPONIBLE:
    result = round(((payslip.indicadores_id.asignacion_familiar_monto_a*carga) / 30) * (dias))
elif payslip.indicadores_id.asignacion_familiar_segundo  >= categories.IMPONIBLE:
    result = round(((payslip.indicadores_id.asignacion_familiar_monto_b*carga) / 30) * (dias))
elif payslip.indicadores_id.asignacion_familiar_tercer  >= categories.IMPONIBLE:
    result = round(((payslip.indicadores_id.asignacion_familiar_monto_c*carga) / 30) * (dias))</field>
        </record>

        <record id="hr_rule_13" model="hr.salary.rule">
            <field name="name">COLACION</field>
            <field name="sequence" eval="13"/>
            <field name="code">COL</field>
            <field name="category_id" ref="NOIMPO"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.colacion > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = round((contract.colacion / 30) * worked_days.WORK100.number_of_days)</field>
        </record>

        <record id="hr_rule_14" model="hr.salary.rule">
            <field name="name">MOVILIZACION</field>
            <field name="sequence" eval="14"/>
            <field name="code">MOV</field>
            <field name="category_id" ref="NOIMPO"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.movilizacion > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = round((contract.movilizacion / 30) * worked_days.WORK100.number_of_days)</field>

        </record>

        <record id="hr_rule_15" model="hr.salary.rule">
            <field name="name">OTROS NO IMPONIBLE</field>
            <field name="sequence" eval="15"/>
            <field name="code">OTRONOIMP</field>
            <field name="category_id" ref="NOIMPO"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.otro_no_imp > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = round((contract.otro_no_imp / 30) * worked_days.WORK100.number_of_days)</field>
        </record>

        <record id="hr_rule_16" model="hr.salary.rule">
            <field name="name">VIATICO</field>
            <field name="sequence" eval="16"/>
            <field name="code">VIASAN</field>
            <field name="category_id" ref="NOIMPO"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.viatico_santiago > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = round((contract.viatico_santiago / 30) * worked_days.WORK100.number_of_days)</field>
        </record>

        <record id="hr_rule_17" model="hr.salary.rule">
            <field name="name">TOTAL NO IMPONIBLE</field>
            <field name="sequence" eval="17"/>
            <field name="code">TOTNOI</field>
            <field name="category_id" ref="SUBT"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = round(categories.NOIMPO)</field>
        </record>

        <record id="hr_rule_18" model="hr.salary.rule">
            <field name="name">PREVISION</field>
            <field name="sequence" eval="18"/>
            <field name="code">PREV</field>
            <field name="category_id" ref="PREV"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">if contract.afp_id.name == 'CAPITAL':
    tasa = payslip.indicadores_id.tasa_afp_capital
elif contract.afp_id.name == 'CUPRUM':
    tasa = payslip.indicadores_id.tasa_afp_cuprum
elif contract.afp_id.name == 'HABITAT':
    tasa = payslip.indicadores_id.tasa_afp_habitat
elif contract.afp_id.name == 'MODELO':
    tasa = payslip.indicadores_id.tasa_afp_modelo
elif contract.afp_id.name == 'PLANVITAL':
    tasa = payslip.indicadores_id.tasa_afp_planvital
elif contract.afp_id.name == 'PROVIDA':
    tasa = payslip.indicadores_id.tasa_afp_provida
else:
    tasa = 0

if contract.pension is True:
    result = 0
elif contract.sin_afp is True:
    result = 0
elif TOTIM >=round(payslip.indicadores_id.tope_imponible_afp*payslip.indicadores_id.uf):
    result =round( round(payslip.indicadores_id.tope_imponible_afp*payslip.indicadores_id.uf)*tasa /100)
else:
    result = round(round(TOTIM)*tasa /100)</field>
        </record>


        <record id="hr_rule_19" model="hr.salary.rule">
            <field name="name">SEGURO CESANTIA</field>
            <field name="sequence" eval="19"/>
            <field name="code">SECE</field>
            <field name="category_id" ref="PREV"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">if contract.pension is True:
     result = 0
elif contract.type_id.name == 'Sueldo Empresarial':
     result = 0
elif contract.type_id.name == 'Plazo Fijo':
     result = 0
elif TOTIM >=round(payslip.indicadores_id.tope_imponible_seguro_cesantia*payslip.indicadores_id.uf):
     result =round(payslip.indicadores_id.tope_imponible_seguro_cesantia*payslip.indicadores_id.uf*payslip.indicadores_id.contrato_plazo_indefinido_trabajador/100)
elif contract.type_id.name == 'Plazo Indefinido':
     result = round(TOTIM*payslip.indicadores_id.contrato_plazo_indefinido_trabajador/100)
elif contract.type_id.name == 'Indefinido 11 anos o mas':
     result = round(TOTIM*payslip.indicadores_id.contrato_plazo_indefinido_trabajador_otro/100)
else:
     result = 0</field>
        </record>


        <record id="hr_rule_20" model="hr.salary.rule">
            <field name="name">APORTE AL AHORRO VOLUNTARIO</field>
            <field name="sequence" eval="20"/>
            <field name="code">APV</field>
            <field name="category_id" ref="PREV"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.aporte_voluntario > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">if contract.aporte_voluntario_moneda == 'uf':
    tasa = payslip.indicadores_id.uf
elif contract.aporte_voluntario_moneda == 'clp':
    tasa = 1
else:
    tasa = 0

if round(contract.aporte_voluntario*tasa) > round(payslip.indicadores_id.tope_mensual_apv * payslip.indicadores_id.uf ):
    result = round(payslip.indicadores_id.tope_mensual_apv * payslip.indicadores_id.uf )
else:
    result = round(contract.aporte_voluntario*tasa)</field>
        </record>

        <record id="hr_rule_21" model="hr.salary.rule">
            <field name="name">SEGURO CESANTIA APORTE EMPRESA</field>
            <field name="sequence" eval="21"/>
            <field name="code">SECEEMP</field>
            <field name="category_id" ref="COMP"/>
            <field name="appears_on_payslip" eval="False"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">amount = 0
if inputs.HEX50:
    amount = inputs.HEX50.amount
DEVENGABLE=round(contract.wage+contract.otros_imp+amount)

GRATI=round(DEVENGABLE * 25 / 100 )
if GRATI > (4.75 * payslip.indicadores_id.sueldo_minimo /12):
    GRATI = round (4.75 * payslip.indicadores_id.sueldo_minimo / 12)
else:
    GRATI = GRATI


if TOTIM >=round(payslip.indicadores_id.tope_imponible_seguro_cesantia*payslip.indicadores_id.uf):
     totimpo =round(payslip.indicadores_id.tope_imponible_seguro_cesantia*payslip.indicadores_id.uf)
elif TOTIM ==0:
     totimpo =round(DEVENGABLE+GRATI)
else:
     totimpo = TOTIM

if contract.pension is True:
     result = 0
elif contract.type_id.name == 'Sueldo Empresarial':
     result = 0
elif contract.type_id.name == 'Plazo Indefinido':
     result = round(totimpo*payslip.indicadores_id.contrato_plazo_indefinido_empleador/100)
elif contract.type_id.name == 'Indefinido 11 anos o mas':
     result = round(TOTIM*payslip.indicadores_id.contrato_plazo_indefinido_empleador_otro/100)
elif contract.type_id.name == 'Plazo Fijo':
     result = round(totimpo*payslip.indicadores_id.contrato_plazo_fijo_empleador/100)
else:
     result = 0</field>
        </record>

        <record id="hr_rule_22" model="hr.salary.rule">
            <field name="name">PREVISION EMPRESA AFP SIS</field>
            <field name="sequence" eval="22"/>
            <field name="code">SIS</field>
            <field name="category_id" ref="COMP"/>
            <field name="appears_on_payslip" eval="False"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">amount = 0
if inputs.HEX50:
    amount = inputs.HEX50.amount
DEVENGABLE=round(contract.wage+contract.otros_imp+amount)

if contract.afp_id.name == 'CAPITAL':
    tasa = payslip.indicadores_id.tasa_sis_capital
elif contract.afp_id.name == 'CUPRUM':
    tasa = payslip.indicadores_id.tasa_sis_cuprum
elif contract.afp_id.name == 'HABITAT':
    tasa = payslip.indicadores_id.tasa_sis_habitat
elif contract.afp_id.name == 'MODELO':
    tasa = payslip.indicadores_id.tasa_sis_modelo
elif contract.afp_id.name == 'PLANVITAL':
    tasa = payslip.indicadores_id.tasa_sis_planvital
elif contract.afp_id.name == 'PROVIDA':
    tasa = payslip.indicadores_id.tasa_sis_provida
else:
    tasa = 0

GRATI=round(DEVENGABLE * 25 / 100 )
if GRATI > (4.75 * payslip.indicadores_id.sueldo_minimo /12):
    GRATI = round (4.75 * payslip.indicadores_id.sueldo_minimo / 12)
else:
    GRATI = GRATI

if contract.pension is True:
    result = 0
elif contract.sin_afp_sis is True:
    result = 0
elif TOTIM >=round(payslip.indicadores_id.tope_imponible_afp*payslip.indicadores_id.uf):
    result = round(round(payslip.indicadores_id.tope_imponible_afp*payslip.indicadores_id.uf)*tasa /100)
elif TOTIM ==0:
     result =round(round(DEVENGABLE+GRATI)*tasa /100)
else:
    result = round(round(TOTIM)*tasa /100)</field>
        </record>


        <record id="hr_rule_23" model="hr.salary.rule">
            <field name="name">MUTUAL SEGURIDAD</field>
            <field name="sequence" eval="23"/>
            <field name="code">MUT</field>
            <field name="category_id" ref="COMP"/>
            <field name="appears_on_payslip" eval="False"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">if payslip.indicadores_id.mutual_seguridad_bool is False:
     result = 0
elif contract.type_id.name == 'Sueldo Empresarial':
     result = 0
elif TOTIM >=round(payslip.indicadores_id.tope_imponible_afp*payslip.indicadores_id.uf):
     result = round(payslip.indicadores_id.tope_imponible_afp*payslip.indicadores_id.uf) * payslip.indicadores_id.mutual_seguridad /100
else:
     result = round(round(TOTIM)*payslip.indicadores_id.mutual_seguridad /100)</field>
            <field name="register_id" ref="contrib_register_previred"/>
        </record>


                <record id="hr_rule_24" model="hr.salary.rule">
            <field name="name">SEGURO COMPLEMENTARIO</field>
            <field name="sequence" eval="24"/>
            <field name="code">SECOMP</field>
            <field name="category_id" ref="COMP"/>
            <field name="condition_select">python</field>
            <field name="appears_on_payslip" eval="False"/>
            <field name="condition_python">result = contract.seguro_complementario > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">if contract.seguro_complementario_moneda == 'uf':
    tasa = payslip.indicadores_id.uf
elif contract.seguro_complementario_moneda == 'clp':
    tasa = 1
else:
    tasa = 0

if round(contract.seguro_complementario*tasa) > round(payslip.indicadores_id.tope_mensual_apv * payslip.indicadores_id.uf ):
    result = round(payslip.indicadores_id.tope_mensual_apv * payslip.indicadores_id.uf )
else:
    result = round(contract.seguro_complementario*tasa)</field>
        </record>


        <record id="hr_rule_25" model="hr.salary.rule">
            <field name="name">AFP X PAGAR</field>
            <field name="sequence" eval="25"/>
            <field name="code">AFP</field>
            <field name="category_id" ref="SUBT"/>
            <field name="condition_select">none</field>
            <field name="appears_on_payslip" eval="False"/>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result =categories.PREV + SIS + SECEEMP</field>
            <field name="register_id" ref="contrib_register_previred"/>
        </record>


<record id="hr_rule_26" model="hr.salary.rule">
            <field name="name">SALUD</field>
            <field name="sequence" eval="26"/>
            <field name="code">SALUD</field>
            <field name="category_id" ref="SALUD"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = 0
Salud=round(7 * round(TOTIM)/100)
if contract.isapre_cuenta_propia:
     result = False
elif Salud >= round((payslip.indicadores_id.tope_imponible_salud*payslip.indicadores_id.tope_imponible_afp/100)*payslip.indicadores_id.uf):
    result = round((payslip.indicadores_id.tope_imponible_salud*payslip.indicadores_id.tope_imponible_afp/100)*payslip.indicadores_id.uf)
else:
    result = round(7 * round(TOTIM)/100)</field>
        </record>


        <record id="hr_rule_27" model="hr.salary.rule">
            <field name="name">ADICIONAL ISAPRE</field>
            <field name="sequence" eval="27"/>
            <field name="code">ADISA</field>
            <field name="category_id" ref="SALUD"/>
            <field name="condition_select">python</field>
            <field name="condition_python">if contract.isapre_id.name == 'FONASA':
    result = False
elif worked_days.WORK100.number_of_days == 0:
     result = False
elif contract.isapre_cuenta_propia:
     result = False
else:
    result = round((payslip.indicadores_id.uf / 30 * (worked_days.WORK100.number_of_days)) * contract.isapre_cotizacion_uf) > round(SALUD)</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result =round ((((payslip.indicadores_id.uf / 30) * (worked_days.WORK100.number_of_days)) * contract.isapre_cotizacion_uf)  - round(SALUD))</field>
        </record>


        <record id="hr_rule_28" model="hr.salary.rule">
            <field name="name">ISAPRES X PAGAR</field>
            <field name="sequence" eval="28"/>
            <field name="code">COLMENA</field>
            <field name="category_id" ref="SUBT"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.isapre_id.name != 'FONASA'</field>
            <field name="appears_on_payslip" eval="False"/>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = categories.SALUD</field>
            <field name="register_id" ref="contrib_register_previred"/>
        </record>



        <record id="hr_rule_33" model="hr.salary.rule">
            <field name="name">CAJA DE COMPENSACION</field>
            <field name="sequence" eval="33"/>
            <field name="code">CAJACOMP</field>
            <field name="category_id" ref="SUBT"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.isapre_id.name == 'FONASA'</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = 0
Salud=round(7 * round(TOTIM)/100)
if Salud >= (payslip.indicadores_id.tope_imponible_salud*payslip.indicadores_id.tope_imponible_afp/100)*payslip.indicadores_id.uf:
    result = round(((payslip.indicadores_id.tope_imponible_salud*payslip.indicadores_id.tope_imponible_afp/100)*payslip.indicadores_id.uf) * (payslip.indicadores_id.caja_compensacion / 7))
else:
    result = round(payslip.indicadores_id.caja_compensacion * round(TOTIM)/100)</field>
            <field name="register_id" ref="contrib_register_previred"/>
        </record>

        <record id="hr_rule_34" model="hr.salary.rule">
            <field name="name">FONASA</field>
            <field name="sequence" eval="34"/>
            <field name="code">FONASA</field>
            <field name="category_id" ref="SUBT"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = contract.isapre_id.name == 'FONASA'</field>
            <field name="amount_select">code</field>
            <field name="appears_on_payslip" eval="False"/>
            <field name="amount_python_compute">result = 0
Salud=round(7 * round(TOTIM)/100)
if Salud >= round((payslip.indicadores_id.tope_imponible_salud*payslip.indicadores_id.tope_imponible_afp/100)*payslip.indicadores_id.uf):
    result =round( round((payslip.indicadores_id.tope_imponible_salud*payslip.indicadores_id.tope_imponible_afp/100)*payslip.indicadores_id.uf) * (payslip.indicadores_id.fonasa / 7))
else:
    result = round(payslip.indicadores_id.fonasa * round(TOTIM)/100)</field>
            <field name="register_id" ref="contrib_register_previred"/>
        </record>



<record id="hr_rule_35" model="hr.salary.rule">
            <field name="name">TRIBUTABLE</field>
            <field name="sequence" eval="35"/>
            <field name="code">TRIBU</field>
            <field name="category_id" ref="SUBT"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">saludtotal = categories.SALUD
if (saludtotal > (payslip.indicadores_id.uf*(payslip.indicadores_id.tope_imponible_salud*payslip.indicadores_id.tope_imponible_afp/100))):

    result = TOTIM - round(payslip.indicadores_id.uf*(payslip.indicadores_id.tope_imponible_salud*payslip.indicadores_id.tope_imponible_afp/100)) - PREV - SECE

else:
    result = round(TOTIM - saludtotal - PREV - SECE)</field>
        </record>





        <record id="hr_rule_36" model="hr.salary.rule">
            <field name="name">IMPUESTO UNICO</field>
            <field name="sequence" eval="36"/>
            <field name="code">IMPUNI</field>
            <field name="category_id" ref="DED"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = TRIBU > payslip.indicadores_id.utm*13.5</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">if payslip.indicadores_id.utm*13.5 > TRIBU :
    result = 0
elif payslip.indicadores_id.utm*30 > TRIBU:
 result = TRIBU*0.04-(payslip.indicadores_id.utm*0.54)
elif payslip.indicadores_id.utm*50 > TRIBU:
 result = TRIBU*0.08-(payslip.indicadores_id.utm*1.74)
elif payslip.indicadores_id.utm*70 > TRIBU:
 result = TRIBU*0.135-(payslip.indicadores_id.utm*4.49)
elif payslip.indicadores_id.utm*90 > TRIBU:
 result = TRIBU*0.23-(payslip.indicadores_id.utm*11.14)
elif payslip.indicadores_id.utm*120 > TRIBU:
 result = TRIBU*0.304-(payslip.indicadores_id.utm*17.80)
elif payslip.indicadores_id.utm*150 > TRIBU:
 result = TRIBU*0.355-(payslip.indicadores_id.utm*23.92)
else:
 result = TRIBU*0.40-(payslip.indicadores_id.utm*30.67)</field>
<field name="register_id" ref="contrib_register_sii"/>

        </record>


       <record id="hr_rule_37" model="hr.salary.rule">
            <field name="name">TOTAL DESC. LEGALES</field>
            <field name="sequence" eval="37"/>
            <field name="code">TODELE</field>
            <field name="category_id" ref="SUBT"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = round(categories.PREV) +  round(categories.SALUD) +  round(categories.DED)</field>
        </record>

       <record id="hr_rule_38" model="hr.salary.rule">
            <field name="name">ANTICIPO DE SUELDO</field>
            <field name="sequence" eval="38"/>
            <field name="code">ASUE</field>
            <field name="category_id" ref="ODESC"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = (contract.anticipo_sueldo > 0) or (inputs.ASUE.amount > 0)</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">if  (inputs.ASUE.amount > 0):
     result = inputs.ASUE.amount
else:
     result = contract.anticipo_sueldo</field>
        </record>

       <record id="hr_rule_38_1" model="hr.salary.rule">
            <field name="name">PRESTAMOS EMPRESA</field>
            <field name="sequence" eval="38"/>
            <field name="code">PRES</field>
            <field name="category_id" ref="ODESC"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result = inputs.PREST and inputs.PREST.amount > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = inputs.PREST.amount</field>
        </record>

       <record id="hr_rule_38_2" model="hr.salary.rule">
            <field name="name">PRESTAMOS CCAF</field>
            <field name="sequence" eval="38"/>
            <field name="code">PCCAF</field>
            <field name="category_id" ref="ODESC"/>
            <field name="condition_select">python</field>
            <field name="condition_python">result =  inputs.PCCAF and inputs.PCCAF.amount > 0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = inputs.PCCAF.amount</field>
        </record>

       <record id="hr_rule_39" model="hr.salary.rule">
            <field name="name">OTROS DESCUENTOS</field>
            <field name="sequence" eval="39"/>
            <field name="code">TOD</field>
            <field name="category_id" ref="SUBT"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = categories.ODESC</field>
        </record>

       <record id="hr_rule_40" model="hr.salary.rule">
            <field name="name">TOTAL GASTOS</field>
            <field name="sequence" eval="40"/>
            <field name="code">HABALG</field>
            <field name="category_id" ref="SUBT"/>
            <field name="appears_on_payslip" eval="False"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">asig = 0
try:
 asig = ASIGFAM
except:
 asig = 0

result = categories.IMPONIBLE + categories.NOIMPO - asig</field>
        </record>


       <record id="hr_rule_41" model="hr.salary.rule">
            <field name="name">TOTAL DESCUENTOS</field>
            <field name="sequence" eval="41"/>
            <field name="code">TDE</field>
            <field name="category_id" ref="SUBT"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = round(TODELE) + round(TOD)</field>
        </record>

        <record id="hr_rule_42" model="hr.salary.rule">
            <field name="name">TOTAL HABERES</field>
            <field name="sequence" eval="42"/>
            <field name="code">HAB</field>
            <field name="category_id" ref="SUBT"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = categories.IMPONIBLE + categories.NOIMPO</field>
        </record>

       <record id="hr_rule_43" model="hr.salary.rule">
            <field name="name">TOTAL APORTE PATRONAL</field>
            <field name="sequence" eval="43"/>
            <field name="code">APORTE</field>
            <field name="category_id" ref="SUBT"/>
            <field name="appears_on_payslip" eval="False"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="active">True</field>
            <field name="amount_python_compute">SC = 0
try:
 SC = round(SECOMP)
except:
 SC = 0
try:
 IS = round(ISL)
except:
 IS = 0
    

result = round(SECEEMP) + round(SIS) + round(MUT) + round(SC) + round(IS)</field>
        </record>


       <record id="hr_rule_44" model="hr.salary.rule">
            <field name="name">ALCANCE LIQUIDO</field>
            <field name="sequence" eval="44"/>
            <field name="code">LIQ</field>
            <field name="category_id" ref="SUBT"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="active">True</field>
            <field name="amount_python_compute">result = HAB - TDE</field>
        </record>

        <record id="hr_rule_45" model="hr.salary.rule">
            <field name="name">COTIZACION ACC. TRABAJO ISL</field>
            <field name="sequence" eval="23"/>
            <field name="code">ISL</field>
            <field name="category_id" ref="COMP"/>
            <field name="appears_on_payslip" eval="False"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">if payslip.indicadores_id.mutual_seguridad_bool is True:
     result = 0
elif contract.type_id.name == 'Sueldo Empresarial':
     result = 0
elif TOTIM >=round(payslip.indicadores_id.tope_imponible_afp*payslip.indicadores_id.uf):
     result = round(payslip.indicadores_id.tope_imponible_afp*payslip.indicadores_id.uf) * payslip.indicadores_id.isl /100
else:
     result = round(round(TOTIM)*payslip.indicadores_id.isl /100)</field>
            <field name="register_id" ref="contrib_register_previred"/>
        </record>

COTIZACION ACC. TRABAJO ISL


        <!-- Rule Inputs -->

        <record id="hr_rule_input_horas_ext_50" model="hr.rule.input">
            <field name="code">HEX50</field>
            <field name="name">HORAS EXTRA ART 32</field>
            <field name="input_id" ref="hr_rule_4"/>
        </record>

        <record id="hr_rule_input_horas_ext_de" model="hr.rule.input">
            <field name="code">HEXDE</field>
            <field name="name">HORAS DESCUENTO</field>
            <field name="input_id" ref="hr_rule_5"/>
        </record>

        <record id="hr_rule_input_bono_produccion" model="hr.rule.input">
            <field name="code">PROD</field>
            <field name="name">BONO DE PRODUCCION</field>
            <field name="input_id" ref="hr_rule_7"/>
        </record>

         <record id="hr_rule_input_comisiones" model="hr.rule.input">
            <field name="code">COMI</field>
            <field name="name">COMISIONES</field>
            <field name="input_id" ref="hr_rule_8"/>
        </record>

         <record id="hr_rule_input_gratificacion_legal" model="hr.rule.input">
            <field name="code">GRAT</field>
            <field name="name">GRATIFICACION LEGAL</field>
            <field name="input_id" ref="hr_rule_9"/>
        </record>

           <record id="hr_rule_input_aguinaldo" model="hr.rule.input">
            <field name="code">AGUI</field>
            <field name="name">AGUINALDO</field>
            <field name="input_id" ref="hr_rule_10"/>
        </record>

        <record id="hr_rule_input_prestamos" model="hr.rule.input">
            <field name="code">PREST</field>
            <field name="name">PRESTAMO EMPRESA</field>
            <field name="input_id" ref="hr_rule_11"/>
        </record>

        <record id="hr_rule_input_prestamos_ccaf" model="hr.rule.input">
            <field name="code">PCCAF</field>
            <field name="name">PRESTAMO CCAF</field>
            <field name="input_id" ref="hr_rule_12"/>
        </record>

        <record id="hr_rule_input_anticipo_sueldo" model="hr.rule.input">
            <field name="code">ASUE</field>
            <field name="name">ANTICIPO DE SUELDO</field>
            <field name="input_id" ref="hr_rule_38"/>
        </record>



 <!-- Estructura Inputs -->

    <record id="hr_struct_cl" model="hr.payroll.structure">
            <field name="name">Codigo del Trabajo</field>
            <field name="code">Codigo del Trabajo de Chile</field>
            <field name="parent_id"></field>
            <field eval="[(6, 0, [ref('hr_rule_1'), ref('hr_rule_2'),ref('hr_rule_3'),ref('hr_rule_4'),ref('hr_rule_5'),ref('hr_rule_6'),ref('hr_rule_7'),ref('hr_rule_8'),ref('hr_rule_9'),ref('hr_rule_10'),ref('hr_rule_11'),ref('hr_rule_12'),ref('hr_rule_13'),ref('hr_rule_14'),ref('hr_rule_15'),ref('hr_rule_16'),ref('hr_rule_17'),ref('hr_rule_18'),ref('hr_rule_19'),ref('hr_rule_20'),ref('hr_rule_21'),ref('hr_rule_22'),ref('hr_rule_23'),ref('hr_rule_24'),ref('hr_rule_25'),ref('hr_rule_26'),ref('hr_rule_27'),ref('hr_rule_28'),ref('hr_rule_33'),ref('hr_rule_34'),ref('hr_rule_35'),ref('hr_rule_36'),ref('hr_rule_37'),ref('hr_rule_38'),ref('hr_rule_38_1'),ref('hr_rule_38_2'),ref('hr_rule_39'),ref('hr_rule_40'),ref('hr_rule_41'),ref('hr_rule_42'),ref('hr_rule_43'),ref('hr_rule_44'),ref('hr_rule_45')])]" name="rule_ids"/>
        </record>








    </data>
</odoo>
